import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

file_path = r"C:\Users\Deepika\OneDrive\Desktop\pythonvs\retail_store_inventory.csv"
df = pd.read_csv(file_path)
print("Available Columns:", df.columns)
print("Available rows and columns",df.shape)
df["Date"] = pd.to_datetime(df["Date"], errors="coerce")
print(df.head())

df["Sales"] = df["Units Sold"] * df["Price"] * (1 - df["Discount"])

for col in df.select_dtypes(include=["number"]).columns:
    df[col] = df[col].fillna(df[col].median())

for col in df.select_dtypes(include=["object"]).columns:
    df[col] = df[col].fillna(df[col].mode()[0])

df.drop_duplicates(inplace=True)

df["Month"] = df["Date"].dt.month
df["Year"] = df["Date"].dt.year
df["Quarter"] = df["Date"].dt.quarter
df["Lag_1"] = df["Sales"].shift(1)
df["Rolling_Mean_3"] = df["Sales"].rolling(window=3).mean()


plt.figure(figsize=(12,6))
df.groupby("Date")["Sales"].sum().plot()
plt.title("Daily Sales Trend")
plt.ylabel("Sales")
plt.show()

plt.figure(figsize=(8,5))
sns.boxplot(x=df["Sales"])
plt.title("Sales Outlier Detection (Boxplot)")
plt.show()

plt.figure(figsize=(12,6))
sns.lineplot(x="Month", y="Sales", hue="Year", data=df, estimator="sum")
plt.title("Seasonality - Monthly Sales Across Years")
plt.show()


# Compute correlation matrix
corr = df.corr(numeric_only=True)

print("\nCorrelation Matrix:\n", corr)


plt.figure(figsize=(10,6))
sns.heatmap(corr, annot=True, cmap="coolwarm", fmt=".2f", linewidths=0.5)
plt.title("Correlation Heatmap of Numeric Features")
plt.show()


output_path = r"C:\Users\Deepika\OneDrive\Desktop\pythonvs\processed dataset.csv"
df.to_csv(output_path, index=False)
print(f"\n Processed dataset saved to: {output_path}")

